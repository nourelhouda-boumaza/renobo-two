<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Buildspace</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        #map {
            position: relative;
            top: 0;
            bottom: 0;
            width: 100%;
            
        }
    </style>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.min.js"
        type="text/javascript"></script>
    <link href="https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.css" rel="stylesheet">
    <div id="map"></div>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="index.html"><img src="logo-white.png" width="50" height="50" alt=""></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="aboutUs.html">About Us</a>
                </li>
                <li class="nav-item  active dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Building Site
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="#" id="fly-button">Buildspace</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    
    <script>
        // TO MAKE THE MAP APPEAR YOU MUST
        // ADD YOUR ACCESS TOKEN FROM
        // https://account.mapbox.com
        mapboxgl.accessToken = 'pk.eyJ1IjoicmVub2JvIiwiYSI6ImNsbHRjbHA0cTAyeW4zZG1kd3FncHptcDEifQ.oz3-6Ilvjwr2SkgDJxv3mw';
        const map = new mapboxgl.Map({
            container: 'map',
            // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
            style: 'mapbox://styles/mapbox/dark-v11',
            center: { lng: -122.43071924561035, lat: 37.806738206553305 },
            zoom: 0,
            pitch: 10,
            bearing: 172.5,
            antialias: true // create the gl context with MSAA antialiasing, so custom layers are antialiased
        });

        // Define the flyToBuilding function
        function flyToBuilding(coordinates) {
            map.flyTo({
                center: coordinates, // Coordinates of the building (longitude, latitude)
                zoom: 15.4, // Adjust the zoom level as needed
                bearing: 172.5, // You can change the bearing (rotation) if desired
                speed: 1.5, // Adjust the animation speed
                curve: 1, // Use a linear animation curve
                pitch: 60,
                easing: function (t) {
                    return t;
                },
                essential: true // This ensures the animation is considered essential and won't be interrupted
            });
        }
        var flyButton = document.getElementById('fly-button');

        flyButton.addEventListener('click', function () {
            // Coordinates of the building (longitude, latitude)
            var buildingCoordinates = [-122.43075947189408, 37.807074033128124]; // Replace with the coordinates of your building
            flyToBuilding(buildingCoordinates);
        });

        // eslint-disable-next-line no-undef
        const tb = (window.tb = new Threebox(
            map,
            map.getCanvas().getContext('webgl'),
            {
                defaultLights: true
            }
        ));

        map.on('style.load', () => {
            map.addLayer({
                id: 'custom-threebox-model',
                type: 'custom',
                renderingMode: '3d',
                onAdd: function () {
                    // Creative Commons License attribution:  Metlife Building model by https://sketchfab.com/NanoRay
                    // https://sketchfab.com/3d-models/metlife-building-32d3a4a1810a4d64abb9547bb661f7f3
                    const scale = 3.2;
                    const options = {
                        obj: 'buildspace_structure_raw3d.gltf',
                        type: 'gltf',
                        scale: { x: 0.0009, y: 0.0009, z: 0.0009 },
                        units: 'meters',
                        rotation: { x: 90, y: 217.5, z: 0 }
                    };

                    tb.loadObj(options, (model) => {
                        model.setCoords([-122.43075947189408, 37.807074033128124]);
                        model.setRotation({ x: 0, y: 0, z: 241 });
                        tb.add(model);
                    });
                },

                render: function () {
                    tb.update();
                }
            });
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</body>

</html>